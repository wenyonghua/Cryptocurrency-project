# ğŸ® ç©å®¶ç®¡ç† API æ–‡æ¡£

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

ç©å®¶ç®¡ç†æ¨¡å—æä¾›äº†å®Œæ•´çš„ç©å®¶ç”¨æˆ·ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š
- ç©å®¶åˆ—è¡¨æŸ¥è¯¢
- ç©å®¶è¯¦æƒ…æŸ¥çœ‹
- ç©å®¶ä¿¡æ¯ç¼–è¾‘
- èµ„äº§å……å€¼/æ‰£é™¤
- æƒé™æ§åˆ¶ï¼ˆç¦ç”¨è´¦å·ã€ç¦æ­¢å……æï¼‰
- ä»£ç†å…³ç³»æŸ¥çœ‹

---

## ğŸ”Œ API æ¥å£åˆ—è¡¨

### 1. ç©å®¶åˆ—è¡¨æŸ¥è¯¢

**æ¥å£åœ°å€**: `GET /admin/player/list`

**æƒé™è¦æ±‚**: `ADMIN`

**è¯·æ±‚å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|------|
| page | Integer | å¦ | é¡µç  | 1 |
| size | Integer | å¦ | æ¯é¡µå¤§å° | 10 |
| username | String | å¦ | ç”¨æˆ·åï¼ˆæ¨¡ç³ŠæŸ¥è¯¢ï¼‰ | "test" |
| phone | String | å¦ | æ‰‹æœºå·ï¼ˆæ¨¡ç³ŠæŸ¥è¯¢ï¼‰ | "138" |
| email | String | å¦ | é‚®ç®±ï¼ˆæ¨¡ç³ŠæŸ¥è¯¢ï¼‰ | "@gmail" |

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "records": [
      {
        "id": 2859435,
        "username": "æ­£å¸¸ç”¨æˆ·",
        "phone": "125830572",
        "email": null,
        "status": 1,
        "vipLevel": 0,
        "uid": "UID100001",
        "inviteCode": "INVITE001",
        "agentId": 2850417,
        "createTime": "2025-12-31 01:11:33"
      }
    ],
    "total": 1,
    "size": 10,
    "current": 1,
    "pages": 1
  }
}
```

---

### 2. è·å–ç©å®¶è¯¦æƒ…

**æ¥å£åœ°å€**: `GET /admin/player/{userId}`

**æƒé™è¦æ±‚**: æ— 

**è·¯å¾„å‚æ•°**:
| å‚æ•°å | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| userId | Long | ç”¨æˆ·ID | 1 |

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "username": "testuser",
    "nickname": "æµ‹è¯•ç”¨æˆ·",
    "uid": "UID100001",
    "email": "test@example.com",
    "phone": "13800138000",
    "vipLevel": 1,
    "kycLevel": 0,
    "status": 1,
    "assets": [
      {
        "currency": "USDT",
        "availableBalance": 1000.00,
        "frozenBalance": 0.00
      }
    ],
    "statistics": {
      "totalDeposit": 5000.00,
      "totalWithdraw": 1000.00,
      "totalTrade": 0.00,
      "inviteCount": 5
    }
  }
}
```

---

### 3. æ›´æ–°ç©å®¶ä¿¡æ¯

**æ¥å£åœ°å€**: `PUT /admin/player/update`

**æƒé™è¦æ±‚**: `ADMIN`

**è¯·æ±‚ä½“**:
```json
{
  "id": 1,
  "nickname": "æ–°æ˜µç§°",
  "email": "newemail@example.com",
  "phone": "13900139000",
  "realName": "å¼ ä¸‰",
  "vipLevel": 2
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": true
}
```

---

### 4. æ›´æ–°ç©å®¶çŠ¶æ€ï¼ˆç¦ç”¨/å¯ç”¨ï¼‰

**æ¥å£åœ°å€**: `PUT /admin/player/{userId}/status`

**æƒé™è¦æ±‚**: æ— 

**è·¯å¾„å‚æ•°**:
| å‚æ•°å | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| userId | Long | ç”¨æˆ·ID | 1 |

**è¯·æ±‚å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|------|
| status | Integer | æ˜¯ | çŠ¶æ€ï¼š0-ç¦ç”¨ï¼Œ1-æ­£å¸¸ | 1 |

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": true
}
```

---

### 5. è®¾ç½®ç©å®¶VIPç­‰çº§

**æ¥å£åœ°å€**: `PUT /admin/player/{userId}/vip-level`

**æƒé™è¦æ±‚**: `ADMIN`

**è·¯å¾„å‚æ•°**:
| å‚æ•°å | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| userId | Long | ç”¨æˆ·ID | 1 |

**è¯·æ±‚å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|------|
| vipLevel | Integer | æ˜¯ | VIPç­‰çº§ | 3 |

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": true
}
```

---

### 6. è°ƒæ•´ç©å®¶èµ„äº§ï¼ˆå……å€¼/æ‰£é™¤ï¼‰

**æ¥å£åœ°å€**: `POST /admin/player/adjust-asset`

**æƒé™è¦æ±‚**: `ADMIN`

**è¯·æ±‚ä½“**:
```json
{
  "userId": 1,
  "currency": "USDT",
  "amount": 100.00,
  "adjustType": 1,
  "remark": "ç®¡ç†å‘˜æ‰‹åŠ¨å……å€¼"
}
```

**å­—æ®µè¯´æ˜**:
- `adjustType`: 1-å……å€¼ï¼ˆå¢åŠ ï¼‰ï¼Œ2-æ‰£é™¤ï¼ˆå‡å°‘ï¼‰
- `amount`: è°ƒæ•´é‡‘é¢ï¼ˆæ­£æ•°ï¼‰
- `remark`: å¤‡æ³¨è¯´æ˜

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": true
}
```

---

### 7. ç¦æ­¢/å…è®¸å……å€¼æç°

**æ¥å£åœ°å€**: `PUT /admin/player/{userId}/deposit-withdraw-status`

**æƒé™è¦æ±‚**: `ADMIN`

**è·¯å¾„å‚æ•°**:
| å‚æ•°å | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| userId | Long | ç”¨æˆ·ID | 1 |

**è¯·æ±‚å‚æ•°**:
| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|------|
| forbidden | Boolean | æ˜¯ | æ˜¯å¦ç¦æ­¢ï¼štrue-ç¦æ­¢ï¼Œfalse-å…è®¸ | true |

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": true
}
```

---

### 8. è·å–ä¸Šçº§ä»£ç†é“¾

**æ¥å£åœ°å€**: `GET /admin/player/{userId}/agent-chain`

**æƒé™è¦æ±‚**: `ADMIN`

**è·¯å¾„å‚æ•°**:
| å‚æ•°å | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| userId | Long | ç”¨æˆ·ID | 1 |

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "id": 100,
      "username": "agent1",
      "nickname": "ä¸€çº§ä»£ç†",
      "uid": "UID100100"
    },
    {
      "id": 200,
      "username": "agent2",
      "nickname": "äºŒçº§ä»£ç†",
      "uid": "UID100200"
    }
  ]
}
```

---

## ğŸ” æƒé™è¯´æ˜

| æ¥å£ | æƒé™è¦æ±‚ | è¯´æ˜ |
|------|----------|------|
| ç©å®¶åˆ—è¡¨ | ADMIN | åªæœ‰ç®¡ç†å‘˜å¯ä»¥æŸ¥çœ‹ |
| ç©å®¶è¯¦æƒ… | æ—  | æ‰€æœ‰å·²ç™»å½•ç”¨æˆ·å¯æŸ¥çœ‹ |
| æ›´æ–°ä¿¡æ¯ | ADMIN | åªæœ‰ç®¡ç†å‘˜å¯ä»¥ä¿®æ”¹ |
| æ›´æ–°çŠ¶æ€ | æ—  | æ‰€æœ‰å·²ç™»å½•ç”¨æˆ·å¯æ“ä½œ |
| è®¾ç½®VIP | ADMIN | åªæœ‰ç®¡ç†å‘˜å¯ä»¥è®¾ç½® |
| è°ƒæ•´èµ„äº§ | ADMIN | åªæœ‰ç®¡ç†å‘˜å¯ä»¥æ“ä½œ |
| ç¦æ­¢å……æ | ADMIN | åªæœ‰ç®¡ç†å‘˜å¯ä»¥æ“ä½œ |
| æŸ¥çœ‹ä»£ç† | ADMIN | åªæœ‰ç®¡ç†å‘˜å¯ä»¥æŸ¥çœ‹ |

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šæŸ¥è¯¢ç©å®¶åˆ—è¡¨

```bash
curl -X GET "http://localhost:8080/admin/player/list?page=1&size=10" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

### ç¤ºä¾‹ 2ï¼šç»™ç©å®¶å……å€¼ USDT

```bash
curl -X POST "http://localhost:8080/admin/player/adjust-asset" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "userId": 1,
    "currency": "USDT",
    "amount": 1000.00,
    "adjustType": 1,
    "remark": "æ´»åŠ¨å¥–åŠ±"
  }'
```

### ç¤ºä¾‹ 3ï¼šç¦ç”¨ç©å®¶è´¦å·

```bash
curl -X PUT "http://localhost:8080/admin/player/1/status?status=0" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

### ç¤ºä¾‹ 4ï¼šç¦æ­¢ç©å®¶å……å€¼æç°

```bash
curl -X PUT "http://localhost:8080/admin/player/1/deposit-withdraw-status?forbidden=true" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **èµ„äº§è°ƒæ•´**
   - æ‰£é™¤èµ„äº§æ—¶ä¼šæ£€æŸ¥ä½™é¢æ˜¯å¦è¶³å¤Ÿ
   - å¦‚æœå¸ç§èµ„äº§ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨åˆ›å»º
   - æ‰€æœ‰èµ„äº§æ“ä½œéƒ½æœ‰äº‹åŠ¡ä¿æŠ¤

2. **ç¦æ­¢å……æ**
   - ä½¿ç”¨ `tags` å­—æ®µå­˜å‚¨æ ‡è®°
   - æ ‡è®°ä¸º `FORBIDDEN_DEPOSIT_WITHDRAW`
   - å‰ç«¯éœ€è¦æ£€æŸ¥æ­¤æ ‡è®°æ¥æ§åˆ¶å……æåŠŸèƒ½

3. **ä»£ç†é“¾æŸ¥è¯¢**
   - æœ€å¤šè¿”å›ä¸¤çº§ä¸Šçº§ä»£ç†
   - æŒ‰ç…§ä»ç›´æ¥ä¸Šçº§åˆ°é¡¶çº§çš„é¡ºåºè¿”å›

4. **æƒé™æ§åˆ¶**
   - æ‰€æœ‰ç®¡ç†æ¥å£éƒ½éœ€è¦ `ADMIN` æƒé™
   - è¯·ç¡®ä¿åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦æœ‰æ•ˆçš„ JWT Token

---

## ğŸš€ æµ‹è¯•å»ºè®®

1. ä½¿ç”¨ Swagger UI æµ‹è¯•ï¼šè®¿é—® `http://localhost:8080/doc.html`
2. ä½¿ç”¨ Postman å¯¼å…¥ API æ–‡æ¡£
3. æ£€æŸ¥åç«¯æ—¥å¿—ç¡®è®¤æ“ä½œæ˜¯å¦æˆåŠŸ
4. éªŒè¯æ•°æ®åº“ä¸­çš„æ•°æ®å˜åŒ–

---

## ğŸ“Š æ•°æ®åº“å­—æ®µè¯´æ˜

### sys_user è¡¨æ–°å¢å­—æ®µ

| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| agent_id | bigint | ä»£ç†ID |
| credit_score | int | ä¿¡ç”¨åˆ†æ•° |
| fund_password | varchar(255) | èµ„é‡‘å¯†ç  |
| email_verified | tinyint | é‚®ç®±éªŒè¯çŠ¶æ€ |
| phone_verified | tinyint | æ‰‹æœºéªŒè¯çŠ¶æ€ |
| google_auth_enabled | tinyint | è°·æ­Œè®¤è¯çŠ¶æ€ |
| wallet_address | varchar(255) | é’±åŒ…åœ°å€ |
| register_domain | varchar(100) | æ³¨å†ŒåŸŸå |
| tags | varchar(255) | ç”¨æˆ·æ ‡ç­¾ |

